import io
import js
import pyodide
from js import Blob, URL

# Step 1: Convert results_df to Excel in memory
excel_buffer = io.BytesIO()
results_df.to_excel(excel_buffer, index=False)
excel_buffer.seek(0)

# Step 2: Convert buffer to JS Blob and create a URL
blob = Blob.new([pyodide.to_js(excel_buffer.getvalue())], { "type": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" })
url = URL.createObjectURL(blob)

# Step 3: Trigger browser download
link = js.document.createElement("a")
link.href = url
link.download = "multinomial_model_results.xlsx"
js.document.body.appendChild(link)
link.click()
js.document.body.removeChild(link)
